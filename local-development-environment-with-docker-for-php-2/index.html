<!DOCTYPE html>
<html data-html-server-rendered="true" lang="en" data-vue-tag="%7B%22lang%22:%7B%22ssr%22:%22en%22%7D%7D">

<head>
    <title>Local Development Environment with Docker for PHP (Part 2) - Nehal Hasnayeen</title><meta name="gridsome:hash" content="f81f61a97dc3face0ac4d7ff528417acd696d55a"><meta data-vue-tag="ssr" charset="utf-8"><meta data-vue-tag="ssr" name="generator" content="Gridsome v0.7.12"><meta data-vue-tag="ssr" data-key="viewport" name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"><meta data-vue-tag="ssr" data-key="format-detection" name="format-detection" content="telephone=no"><link data-vue-tag="ssr" rel="icon" href="data:,"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="16x16" href="/assets/static/favicon.ce0531f.cb378d42455bb1986bab5c68bf53969d.png"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="32x32" href="/assets/static/favicon.ac8d93a.cb378d42455bb1986bab5c68bf53969d.png"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="96x96" href="/assets/static/favicon.b9532cc.cb378d42455bb1986bab5c68bf53969d.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="76x76" href="/assets/static/favicon.f22e9f3.cb378d42455bb1986bab5c68bf53969d.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="152x152" href="/assets/static/favicon.62d22cb.cb378d42455bb1986bab5c68bf53969d.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="120x120" href="/assets/static/favicon.1539b60.cb378d42455bb1986bab5c68bf53969d.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="167x167" href="/assets/static/favicon.dc0cdc5.cb378d42455bb1986bab5c68bf53969d.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="180x180" href="/assets/static/favicon.7b22250.cb378d42455bb1986bab5c68bf53969d.png"><link rel="preload" href="/assets/css/0.styles.d1fba2f2.css" as="style"><link rel="preload" href="/assets/js/app.8e2879ca.js" as="script"><link rel="preload" href="/assets/js/page--src--templates--blog-post-vue.725efc4f.js" as="script"><link rel="prefetch" href="/assets/js/15.5281b87b.js"><link rel="prefetch" href="/assets/js/16.4e406a2a.js"><link rel="prefetch" href="/assets/js/page--node-modules--gridsome--app--pages--404-vue.61156de0.js"><link rel="prefetch" href="/assets/js/page--src--pages--about-vue.576262a8.js"><link rel="prefetch" href="/assets/js/page--src--pages--blog-vue.d71b34cc.js"><link rel="prefetch" href="/assets/js/page--src--pages--bn--eli5-vue.5950b8a2.js"><link rel="prefetch" href="/assets/js/page--src--pages--contacts-vue.a04984c2.js"><link rel="prefetch" href="/assets/js/page--src--pages--credits-vue.512bfb1e.js"><link rel="prefetch" href="/assets/js/page--src--pages--hire-me-vue.e40c2d18.js"><link rel="prefetch" href="/assets/js/page--src--pages--index-vue.49ed9864.js"><link rel="prefetch" href="/assets/js/page--src--pages--projects-vue.a08bb803.js"><link rel="prefetch" href="/assets/js/page--src--pages--reading-vue.248d0f54.js"><link rel="prefetch" href="/assets/js/page--src--templates--eli5-post-vue.d623972a.js"><link rel="prefetch" href="/assets/js/page--src--templates--now-page-vue.558117c9.js"><link rel="stylesheet" href="/assets/css/0.styles.d1fba2f2.css"><noscript data-vue-tag="ssr"><style>.g-image--loading{display:none;}</style></noscript>
</head>

<body class="font-display overflow-x-hidden bg-indigo-100 text-gray-800 " data-vue-tag="%7B%22class%22:%7B%22ssr%22:%22font-display%20overflow-x-hidden%20bg-indigo-100%20text-gray-800%20%22%7D%7D">

    <script>
        // Borrowed from gridsome.org
        (function () {
            window.__onThemeChange = function () { };
            function setTheme(newTheme) {
                window.__theme = newTheme;
                preferredTheme = newTheme;
                window.__onThemeChange(newTheme);
            }

            var preferredTheme;
            try {
                preferredTheme = localStorage.getItem('theme');
            } catch (err) { }

            window.__setPreferredTheme = function (newTheme) {
                setTheme(newTheme);
                try {
                    localStorage.setItem('theme', newTheme);
                } catch (err) { }
            }

            var darkQuery = window.matchMedia('(prefers-color-scheme: dark)');

            darkQuery.addListener(function (e) {
                window.__setPreferredTheme(e.matches ? 'dark' : 'light');
            });

            setTheme(preferredTheme || (darkQuery.matches ? 'dark' : 'light'));
        })();
    </script>

    <div data-server-rendered="true" id="app" class="bg-indigo-100 text-gray-800 " data-v-f4dd72bc><div class="flex flex-col min-h-screen max-w-6xl mx-auto"><header class="lg:py-4 lg:px-16 flex justify-between items-center"><div class="overflow-hidden h-16"><a href="/" class="active"><div class="flex items-center"><img alt="logo" src="data:image/svg+xml,%3csvg fill='none' viewBox='0 0 300 300' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cdefs%3e%3cfilter id='__svg-blur-87501807c8c267514290334f28fc0fec'%3e%3cfeGaussianBlur in='SourceGraphic' stdDeviation='40'/%3e%3c/filter%3e%3c/defs%3e%3cimage x='0' y='0' filter='url(%23__svg-blur-87501807c8c267514290334f28fc0fec)' width='300' height='300' xlink:href='data:image/svg%2bxml%3bbase64%2ciVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAACXBIWXMAAAsTAAALEwEAmpwYAAALaElEQVR42u1afZBVZRm/594LbnyIgpIoTUaDoWWgVmAfRiEfCrv3nF1YFkmxUZkcQadRSWpKbQwdTaaUUUIx9t6zgCgQCBGjDX9EYZKfTH7UgJklBYIhH7t7zi6n3%2b89z3vOey%2b7wL27sDt635ln33PP1/s%2b37/nOZtIlEd5lEd5lEd5lMdJHlaZ%2bY/56PtxZDop8wTQQdC8gvMf%2bZGS%2bUFQANpWoutY3VGzqSIEME8E8MJHIW5YRWxSC%2bA%2bEcDWIl3nfLGau7uLUPQGRoGqi7CAUgWwTp7b0Z003x%2b0RzY2Q86lO1EA%2bplx8gzp%2bwXXujywbZaN7QN99iiRvVQL4PiDPPMmqGd3cQHN5OdBh2SDmzrRBfT9Uw3tz%2bhO2jfNfbaxybntuEIpWYDPvFZC1uiSeLBeNuqDvtSGpgpxwGvHof3vGYKt6m7aL3SFc0C7ZbMvt2EB%2br7Jcs%2bjykx69UteevszCcf1EnbOS1ScfrYW6Kmgf8i9z3V3PKCZrTM09oCpsXRFDP%2bTPSoGn1c5p%2beqILDGPfhmymloseycbzmub4285Sn1rj5nDR2YsKy98q6R3RI2X/nozkTvgUPCnaV6qs1ZydTj%2bBNYyfQT/F1x2qDIZCcu2p349r0vpYtY4ly8R7nTBbU/U%2b8fdHEVLKU54YC6bGSyobmGx02J6qVB8mt3bDB981J9MOLah6nZJDYdae/yB17vjefG2q53B96zCLQSLrAW8wrQI7h/Tqa%2bserW3cEAc11YSQrXlRs4uXgPJ3Vg01jclw15yZqG1ujapMf29K9eHlx4w4vBJVOeDkZllhwcYj5b5Tam8cxc0PbqZUFQ90wQXPVb0AaD8LtuXRDUPBkEdrZpPwSxCfffAjrb2ENKM39ShUDmY214KeP4SqU9138H/hxMfipQBE024vyf5PoA0Jba3wTBVBAEFeD3DtCzovkGWgKIDG8HtdauDoJpEAZnaHwPzv0SNEgswNLWQCE47gkWRJUb%2bxwsICULXwD6PbVVtzbUaE3ImAdqhMAOT1mlBMFz71Io1UsPB8LoN0FtNkZ4HuY%2bAvMs0Dq%2bi0KjIOxQENcb91onxRKqxewN5m1ujJsiYzjeBvoRaBzoM6ArQG9Qk3imGdQqwvlp3nvdFsXA2CUf8p397azXrw2BDINAFmBumrIyCOBefM/CQiFkTpQQtHQdMXv8Hu80tGrG94FurMrGQQ6/L6J58x5utnZVaB2wiPcqG5rScg/jQVKOrwa9Avob6O%2bgrSAyPKJgH18EPT95RWQNC0UpFjPDCbUCw9TOAO0ULbwHGq7QDXK4COksnNslG/RBT4PxezFnQWN18Az9tkW/86VrNiE2rAkFRb/nMc4fpnDVe10vLILWzOf9KykE2cP0wpjU%2bWmPedcV03e9e%2biPwtxlwnRPalQ28kO53gyqPFKQIijXN4X6VdB8vPtmzLOpWQqRsUXc5jK5Twlh/EP7ePyCrPPKFb8%2bmIwsNQg6W/N%2bnPPrm5l%2btilzznlLhJEeE7MHIJgoNtw6/XfqeoNcT8FE05y1yes0erTgJXHkXaZGzDl5V1ILAfNEWgFjDF1DW1anYgQj12rzHojjDxiIMNeZpmfcS98eA4GcXhilnTiWRNhfb1wElVKz62smr5eMcp0GQsbeGGR1YB0WWqcSUAyUOpIa7RjsqBer46w3mEFPBHBDG3igPQG2u0am3hfr8mUtT2MOS%2bZPhFmoRb%2brF%2bg5UAuESOG0gIgiM3GaPtLSSgI8SmvLIkFcLVHaE997VszSsnN52gyDnGagnU3YYVyJLAzMKEHWZFvid8WB1QQ9Z4IO6vTLmRhEMhJB1Zl5Vpv1SjN9O%2bvTTHVwuYta52LA/RrozDMFUOz7py8/nDjCrLPNafMeB3ugMrRCHBFImA79azCT7mEWoStI5ng%2bjkd%2bh/xf%2b7ZD6SpsnvP%2bwlSm4ajOEMVZl2/EAl8L%2bFMqCxA4ud5iO3eoXXSnraaN/f6EaVNg8wzNA4VYcvCbmG1kUHlVcvo2FCd9zI0I%2bEhKcaKYqUZxZG7cdv1C96C5W3hG0qZP5Pg/rjF9o1pnP%2bg004xjl2nJC5pkUKdfOb%2bFGII1g85AJWUDA6GNZtUm2q%2bSc6fY4pN2Q0tehwaF0NHiiTVnfVC4znmE0xJUyfhjoJECfNrt/tgNfmR5eq8Zt7kCa70lKfo%2bDdtLygSG%2bc8Rv3rHdpv7hIs3R4vKPaMYD3QUVrBUFs1IAWW7pia9wWBuGM71BbkSUPdqsHMs5ttBp8QMmxgHRFmXdwgdGgL4hZjUltC8W0zrOJVlLPE%2ba3gWKtp0ndA0U7YZvV3v0yCWxu/DNPfheCfoAOuESGOuVxGBGQjxaMWNwXw/0L8JiwUY1cegqVk1bIoeuuLD/HMRwFYTxuJ3D9b5tA6R%2bC5G43ZSqgY146etDyM1mebMTdPFpP4flofmjhG8oriSbe6r4tSqaC8vOlJmmzGkWBygcf9NYqK7dH418T6CEq/dn3H9XpIR0qpp4Xob6D6goVG2qG9iQK0FfRc0gUUMaCk260uQ3dweoJqyIiAIyw%2bkoXWZrjiT8YSYANdu0pbolBIEndjMR%2bC4VaquWcIkg%2bBWLkQXKNDK%2bWSG%2bF2YYkfooUzWO%2bUompxNaxDz/YK2goyZPepV3LFUWhNUGj2/%2bKAlQq0jBhCLnd%2bhLEAIaaCwjUYnZoS4whs0Z/y%2bWZv5VUs1sFH4nRawl9FdLOiP0GAvo1aI0teEJxQDhLKrKdw8C5i/QKe8fKazXh9iB917UAIMkeAhWW%2bWjmWZUusBI9gNJ/KjFThhtCbyej2UtH9btFABIMK5c0CPM0hKJlloVHRRUdSG9RnwOK/4GQq6HbRRmiZEoy6yUw8oQDVJpN22PZNr0sK2FA4pVggabcXtL3%2bS7suRGVxvFau4U8BOWqPCQjNlm1vyPC3ojIg5AxwR4pqQ2skvsKAAfzn7Cwx0OnDK%2bn8N062qUncYHaox2tr0GtVuEYiwOhe3vg24%2bjnp6rzNzchi61U3qKHVEtPWhRHnCklnoxidJdpP0hajNmVWnJoEISJu9Gb8YLWnrM/1QWy0%2btT8bgZfpuL8vqH3vgj7AF2jUAiOWwRsN33HKQAUeNmPqQ2aN/v8xwioi8n8lDDf3yUxI0aTYXss6eRD2q%2bw8qSWyRCfZxGm%2b4uy7n9AT7K7bGSvrxOPiHJ2gs7Nd2e/6Dhg%2bmRSV1mVS5ot3ZISza4nVGaRZIeaG4DNjAatJjqjb0qO/vNxrDkTax4i406D8ml%2bOeK7voz5Wif8fvCB6h%2bujYSxCnSJPD9BCTy0BHal%2b3cIE2RQgFAIY%2bq9fJToqrp8swY1ksbof/%2biKXITUXR2vR3EDPIxZA2hqgS1IWK6rDDvBL1csyLUMplk670dIbHxehsDnpFp6BoLdAXLnqWcXyTaT3a4TRZXdWFcGL1kf0I%2bW20jg3ozZEAs421%2b/0NwJHJcSo0Z3xHYyWmkb1N4U%2bXDighys9HmSoWBVblKys7PDLS2H6guNNasDRl%2bS0DYLhFArjD7lN4dLvguaKA8BsCLQd8Bw7NB1%2bH4G2xf6XvGLlQZYm4Ie32fLqG%2bFC1jgPM8vPef8oksY/h0OnP3fwu/Tegga8aMT1LTVAIFrIQRWtGHrDgL99thKzDre%2bcYFZcuiuIvyz4D4EUOvxe6XiWYHwsaDs1GvYZphL46cJnN02WNKpA5%2bf0FUxDfYneIAmZNQKWYFtupozJsmeX3AZWJCoW/rRtfDQxh%2balj1CBJnSI18zN/FRyPIiLQVJVV7nZhzeLDlsm8au9nu%2bh/CmxBiZlco/7OkHREWI4r/q1aZX4ExI63iMnrPh2ZrqPusN2V/1BxwgWc9fI62aGA/biu6Yp/pCiP8iiP8iiP8uj%2b4//jX3SFCt7MOAAAAABJRU5ErkJggg==' /%3e%3c/svg%3e" width="300" data-src="/assets/static/logo.6b65613.ea0a5de436c285073b21124a0998bc66.svg" data-srcset="/assets/static/logo.6b65613.ea0a5de436c285073b21124a0998bc66.svg 300w" data-sizes="(max-width: 300px) 100vw, 300px" class="w-16 h-16 g-image g-image--lazy g-image--loading"><noscript><img src="/assets/static/logo.6b65613.ea0a5de436c285073b21124a0998bc66.svg" class="w-16 h-16 g-image g-image--loaded" width="300" alt="logo"></noscript><span class="text-3xl pl-2 text-indigo-600 ">hasnayeen</span></div></a></div><div><div class="pr-2 cursor-pointer lg:hidden"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-8"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg></div><nav class="flex items-center"><div class="hidden lg:flex items-center"><div class="mr-8"><div id="theme-menu" class="font-black text-sm cursor-default px-3 py-1 rounded-full bg-gray-800 text-white ">Light</div><div id="theme-dropdown" class="absolute pt-4 z-30"><div class="w-2 h-2 mt-3 ml-8 bg-indigo-600 absolute top-0 arrow"></div><div class="bg-indigo-600 rounded-lg shadow py-2 flex flex-col w-28"><div class="cursor-pointer font-semibold px-4 py-2 text-white hover:text-indigo-600 hover:bg-white">Light</div><div class="cursor-pointer font-semibold px-4 py-2 text-white hover:text-indigo-600 hover:bg-white">Dark</div><div class="cursor-pointer font-semibold px-4 py-2 text-white hover:text-indigo-600 hover:bg-white">Sepia</div><div class="cursor-pointer font-semibold px-4 py-2 text-white hover:text-indigo-600 hover:bg-white">Mountain</div></div></div></div><a href="/about" class="font-semibold mr-8">About</a><div class="mr-8"><div id="more-menu" class="font-semibold cursor-default">More</div><div id="more-dropdown" class="absolute pt-4 -ml-16 z-30"><div class="w-2 h-2 mt-3 ml-20 bg-indigo-600 absolute top-0 arrow"></div><div class="bg-indigo-600 rounded-lg shadow py-4 flex flex-col w-48"><div class="font-semibold px-8 py-2 text-white hover:text-indigo-600 hover:bg-white cursor-pointer">Console</div><a href="/now" class="font-semibold px-8 py-2 text-white hover:text-indigo-600 hover:bg-white">Now</a><a href="/reading" class="font-semibold px-8 py-2 text-white hover:text-indigo-600 hover:bg-white">Reading</a><a href="/projects" class="font-semibold px-8 py-2 text-white hover:text-indigo-600 hover:bg-white">Projects</a><a href="/blog" class="font-semibold px-8 py-2 text-white hover:text-indigo-600 hover:bg-white">Blog</a><div class="border-t px-8 pt-4 pb-2 text-orange-400 text-sm font-semibold">Series</div><a href="/bn/eli5" class="font-semibold px-8 py-2 text-white hover:text-indigo-600 hover:bg-white">Eli5 (বাংলা)</a></div></div></div><a href="/hire-me" class="font-extrabold uppercase bg-indigo-600 text-white px-4 py-2 rounded">Hire Me</a></div><!----></nav></div></header><main class="flex-grow pt-8 mx-4 md:mx-16"><!----><div data-v-f4dd72bc><div class="max-w-4xl container px-4 lg:px-24 py-8 lg:py-16 rounded-lg shadow-xl bg-white text-gray-800 " data-v-f4dd72bc><div class="text-center" data-v-f4dd72bc><span class="border-b border-indigo-600 pb-1" data-v-f4dd72bc>
          May 27, 2017
        </span></div><div class="text-center pb-4 pt-1" data-v-f4dd72bc><span data-v-f4dd72bc>
          4 min read
        </span></div><h1 class="text-2xl md:text-4xl pb-4 text-center text-indigo-600 " data-v-f4dd72bc>Local Development Environment with Docker for PHP (Part 2)</h1><div class="md:text-lg leading-relaxed blog" data-v-f4dd72bc><p><strong><em>Setting MySQL, Adminer and Redis</em></strong></p>
<p>In our last <a href="/local-development-environment-with-docker-for-php">post</a> we installed docker in our machine and setup our environment with several containers. We added nginx container as a server, a php-fpm container and and installed a laravel application. Now we’ll install a mysql database to persist our application data.</p>
<section><h3 id="install-mysql"><a href="#install-mysql" aria-hidden="true"><span class="icon icon-link"></span></a>Install MySQL</h3><p>Before we create a mysql container we’ll create a volume to persist the database data and map it to a directory in the docker host. These volume will persist our data even if we remove the mysql container so we’ll not lose our data. Go to the volumes page in portainer dashboard and create a volume with any name you want</p><p><img src="https://cdn-images-1.medium.com/max/2100/1*ur0pakZo72aujOWtKATx_Q.png" alt="Create a volume to persist db data"><em>Create a volume to persist db data</em></p><p>Now let’s create a mysql container</p><p><img src="https://cdn-images-1.medium.com/max/2448/1*C4YmteRZNkzXn8dQOzfMag.png" alt="Create a mysql container"><em>Create a mysql container</em></p><p>Give the container a name and let’s use the official mysql image. We don’t need to expose any ports publicly because our application will talk to the db and it can because it’ll be in the same network. Attach the newly created volume to /var/lib/mysql directory in docker host</p><p><img src="https://cdn-images-1.medium.com/max/2412/1*q0zi20rBRh1kPHzcrKub7A.png" alt="Attach db-data volume to docker host"><em>Attach db-data volume to docker host</em></p><p>Also select the php network in the network tab. In the Env tab add the below environment varibles</p><p><img src="https://cdn-images-1.medium.com/max/2414/1*UhaTQ2dS-eD30KOcArGQuw.png" alt="Add environment variable for our container"><em>Add environment variable for our container</em></p><p>MYSQL_ROOT_PASSWORD create a password for root mysql user, MYSQL_DATABASE creates database with the name and it’s optional so you can omit this if you want. MYSQL_USER and MYSQL_PASSWORD create a new mysql user and its password and these are optional too. Now create the container by hitting start container button.</p><p>Let’s check our application can connect to the database. First configure our database connection in env file of our project.</p><pre class="language-text"><code class="language-text">DB_CONNECTION=mysql
DB_HOST=db
DB_PORT=3306
DB_DATABASE=example
DB_USERNAME=hasnayeen
DB_PASSWORD=secret</code></pre><p>Now connect to php container bash console from portainer dashboard and you’ll be in the /var/www directory. cd into the example directory and run migration command</p><p><img src="https://cdn-images-1.medium.com/max/2422/1*TjvfcGB9HWK7e7DCfBvEHQ.png" alt="Test our application can talk to db container"><em>Test our application can talk to db container</em></p><p>Our application has successfully connected to the db container and migrated the default database tables.</p></section>
<section><h3 id="install-adminer"><a href="#install-adminer" aria-hidden="true"><span class="icon icon-link"></span></a>Install Adminer</h3><p>We can use the mysql cli in the dbcontainer to interact with database but we like to do it through a graphical interface. Many people use phpmyadmin as a database manager but I personally use adminer so I’m going to create a container using the official adminer image</p><p><img src="https://cdn-images-1.medium.com/max/2490/1*3nEZVkit9x1LtO5je-UVeA.png" alt="Create a adminer container"><em>Create a adminer container</em></p><p>I named the container adminer and published all exposed port. Docker is going to assign a random port to 8080 of the container but if you want to assign a specific port on your host then you can map it through the Port mapping option. Let’s create the container</p><p><img src="https://cdn-images-1.medium.com/max/2478/1*hILFuScsQKF_H-uZAcidwQ.png" alt="Our adminer container is running and mapped to a random port"><em>Our adminer container is running and mapped to a random port</em></p><p>You can see docker has assigned 32768 port to container 8080 port. Click the link and we see the login page of adminer</p><p><img src="https://cdn-images-1.medium.com/max/2648/1*51oqrt5YrChLVCSXcnfURw.png" alt="Login page of adminer"><em>Login page of adminer</em></p><p>Fill all the field with proper value and hit login. Remember the server name is the name of the container of our mysql container which is in our case db.</p><p><img src="https://cdn-images-1.medium.com/max/2646/1*f0RoTwAdGIPBcq86WFxG5A.png"></p></section>
<section><h3 id="install-redis"><a href="#install-redis" aria-hidden="true"><span class="icon icon-link"></span></a>Install Redis</h3><p>Let’s now create a redis container to use as a cache memory.</p><p><img src="https://cdn-images-1.medium.com/max/2070/1*t1rRZ0mydVzd9isqqVxMfQ.png" alt="Create a redis container"><em>Create a redis container</em></p><p>Attach the container to the php network and to persist our data we can use the db-data volume and mapped it to /var/lib/redis directory of docker host. Finally add a command in the command tab to run redis with appendonly mode and create the container</p><p><img src="https://cdn-images-1.medium.com/max/2414/1*pp9X1Yeb9d75FyHK3J2_9Q.png" alt="Add a command to run redis with appendonly mode"><em>Add a command to run redis with appendonly mode</em></p><p>Now we need to configure our .env file in our application</p><pre class="language-text"><code class="language-text">CACHE_DRIVER=redis

REDIS_HOST=redis
REDIS_PASSWORD=null
REDIS_PORT=6379</code></pre><p>Cache driver will be redis and redis host name is the name of our container which is redis. We’ll also need to predis/predis package to use redis in our application. So connect to the php container bash terminal and install the package</p><pre class="language-text"><code class="language-text">$ composer require predis/predis</code></pre><p>After predis has been installed let’s check it’s working. We’ll add to route to our routes file, one for putting a value in the cache and one to get the value, so add the below code in the routes/web.php file</p><pre class="language-text"><code class="language-text">Route::get(&#39;get&#39;, function() {
    return \Illuminate\Support\Facades\Cache::get(&#39;hello&#39;);
});

Route::get(&#39;put&#39;, function() {
    return \Illuminate\Support\Facades\Cache::put(&#39;hello&#39;, &#39;world&#39;, 5);
});</code></pre><p>Now first visit the put routes to put world as a value of hello key. It’ll return nothing but if we now visit the get route we’ll see it retrieve the value of hello key from the cache and return it to us.</p><p><img src="https://cdn-images-1.medium.com/max/2640/1*OMac2ow4KGEYNoE2ug04og.png" alt="Checking our redis container is working"><em>Checking our redis container is working</em></p></section>
<section><h3 id="conclusion"><a href="#conclusion" aria-hidden="true"><span class="icon icon-link"></span></a>Conclusion</h3><p>So we have added few more containers and our machine is ready to build awesome applications with laravel.</p><p>In next post we’ll see how we can use different PHP versions and databases to test our application without messing with our host machine.</p><p>If you liked the content please consider to share the knowledge and don’t forget to subscribe for more.</p><p><a href="/local-development-environment-with-docker-for-php">Part-1</a></p><p><a href="/local-development-environment-with-docker-for-php-3">Part-3</a></p></section>
</div></div><div class="rounded-lg shadow-xl mt-16 mx-auto px-4 lg:px-24 py-8 lg:py-16 max-w-4xl bg-white text-gray-800 " data-v-f4dd72bc><div data-v-f4dd72bc><div class="text-xl font-semibold" data-v-f4dd72bc>
          Comments:
        </div><div data-v-f4dd72bc>
          If you found any error or have any suggestion let me know in the comments.
        </div></div><script src="https://utteranc.es/client.js" repo="Hasnayeen/hasnayeen.github.io" issue-term="title" label="comments" theme="github-light" crossorigin="anonymous" async="async" data-v-f4dd72bc></script></div></div></main><footer class="mt-16 py-4 px-4 lg:px-16 flex flex-col lg:flex-row-reverse lg:bg-transparent justify-between bg-indigo-100 text-gray-800 "><div><span class="font-semibold mr-12 hidden md:inline cursor-pointer">Console</span><a href="/credits" class="font-semibold mr-12">Credits</a><a href="/contacts" class="font-semibold">Contacts</a></div><div class="text-sm lg:text-base text-orange-600 ">
        Copyright © 2020 hasnayeen.dev. All rights reserved.
      </div></footer></div></div>
    <script>window.__INITIAL_STATE__={"data":{"blogPost":{"id":"62ad110dfb40b6d22f2b0f34d019db66","title":"Local Development Environment with Docker for PHP (Part 2)","date":"May 27, 2017","content":"\u003Cp\u003E\u003Cstrong\u003E\u003Cem\u003ESetting MySQL, Adminer and Redis\u003C\u002Fem\u003E\u003C\u002Fstrong\u003E\u003C\u002Fp\u003E\n\u003Cp\u003EIn our last \u003Ca href=\"\u002Flocal-development-environment-with-docker-for-php\"\u003Epost\u003C\u002Fa\u003E we installed docker in our machine and setup our environment with several containers. We added nginx container as a server, a php-fpm container and and installed a laravel application. Now we’ll install a mysql database to persist our application data.\u003C\u002Fp\u003E\n\u003Csection\u003E\u003Ch3 id=\"install-mysql\"\u003E\u003Ca href=\"#install-mysql\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EInstall MySQL\u003C\u002Fh3\u003E\u003Cp\u003EBefore we create a mysql container we’ll create a volume to persist the database data and map it to a directory in the docker host. These volume will persist our data even if we remove the mysql container so we’ll not lose our data. Go to the volumes page in portainer dashboard and create a volume with any name you want\u003C\u002Fp\u003E\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F2100\u002F1*ur0pakZo72aujOWtKATx_Q.png\" alt=\"Create a volume to persist db data\"\u003E\u003Cem\u003ECreate a volume to persist db data\u003C\u002Fem\u003E\u003C\u002Fp\u003E\u003Cp\u003ENow let’s create a mysql container\u003C\u002Fp\u003E\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F2448\u002F1*C4YmteRZNkzXn8dQOzfMag.png\" alt=\"Create a mysql container\"\u003E\u003Cem\u003ECreate a mysql container\u003C\u002Fem\u003E\u003C\u002Fp\u003E\u003Cp\u003EGive the container a name and let’s use the official mysql image. We don’t need to expose any ports publicly because our application will talk to the db and it can because it’ll be in the same network. Attach the newly created volume to \u002Fvar\u002Flib\u002Fmysql directory in docker host\u003C\u002Fp\u003E\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F2412\u002F1*q0zi20rBRh1kPHzcrKub7A.png\" alt=\"Attach db-data volume to docker host\"\u003E\u003Cem\u003EAttach db-data volume to docker host\u003C\u002Fem\u003E\u003C\u002Fp\u003E\u003Cp\u003EAlso select the php network in the network tab. In the Env tab add the below environment varibles\u003C\u002Fp\u003E\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F2414\u002F1*UhaTQ2dS-eD30KOcArGQuw.png\" alt=\"Add environment variable for our container\"\u003E\u003Cem\u003EAdd environment variable for our container\u003C\u002Fem\u003E\u003C\u002Fp\u003E\u003Cp\u003EMYSQL_ROOT_PASSWORD create a password for root mysql user, MYSQL_DATABASE creates database with the name and it’s optional so you can omit this if you want. MYSQL_USER and MYSQL_PASSWORD create a new mysql user and its password and these are optional too. Now create the container by hitting start container button.\u003C\u002Fp\u003E\u003Cp\u003ELet’s check our application can connect to the database. First configure our database connection in env file of our project.\u003C\u002Fp\u003E\u003Cpre class=\"language-text\"\u003E\u003Ccode class=\"language-text\"\u003EDB_CONNECTION=mysql\nDB_HOST=db\nDB_PORT=3306\nDB_DATABASE=example\nDB_USERNAME=hasnayeen\nDB_PASSWORD=secret\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003ENow connect to php container bash console from portainer dashboard and you’ll be in the \u002Fvar\u002Fwww directory. cd into the example directory and run migration command\u003C\u002Fp\u003E\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F2422\u002F1*TjvfcGB9HWK7e7DCfBvEHQ.png\" alt=\"Test our application can talk to db container\"\u003E\u003Cem\u003ETest our application can talk to db container\u003C\u002Fem\u003E\u003C\u002Fp\u003E\u003Cp\u003EOur application has successfully connected to the db container and migrated the default database tables.\u003C\u002Fp\u003E\u003C\u002Fsection\u003E\n\u003Csection\u003E\u003Ch3 id=\"install-adminer\"\u003E\u003Ca href=\"#install-adminer\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EInstall Adminer\u003C\u002Fh3\u003E\u003Cp\u003EWe can use the mysql cli in the dbcontainer to interact with database but we like to do it through a graphical interface. Many people use phpmyadmin as a database manager but I personally use adminer so I’m going to create a container using the official adminer image\u003C\u002Fp\u003E\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F2490\u002F1*3nEZVkit9x1LtO5je-UVeA.png\" alt=\"Create a adminer container\"\u003E\u003Cem\u003ECreate a adminer container\u003C\u002Fem\u003E\u003C\u002Fp\u003E\u003Cp\u003EI named the container adminer and published all exposed port. Docker is going to assign a random port to 8080 of the container but if you want to assign a specific port on your host then you can map it through the Port mapping option. Let’s create the container\u003C\u002Fp\u003E\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F2478\u002F1*hILFuScsQKF_H-uZAcidwQ.png\" alt=\"Our adminer container is running and mapped to a random port\"\u003E\u003Cem\u003EOur adminer container is running and mapped to a random port\u003C\u002Fem\u003E\u003C\u002Fp\u003E\u003Cp\u003EYou can see docker has assigned 32768 port to container 8080 port. Click the link and we see the login page of adminer\u003C\u002Fp\u003E\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F2648\u002F1*51oqrt5YrChLVCSXcnfURw.png\" alt=\"Login page of adminer\"\u003E\u003Cem\u003ELogin page of adminer\u003C\u002Fem\u003E\u003C\u002Fp\u003E\u003Cp\u003EFill all the field with proper value and hit login. Remember the server name is the name of the container of our mysql container which is in our case db.\u003C\u002Fp\u003E\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F2646\u002F1*f0RoTwAdGIPBcq86WFxG5A.png\"\u003E\u003C\u002Fp\u003E\u003C\u002Fsection\u003E\n\u003Csection\u003E\u003Ch3 id=\"install-redis\"\u003E\u003Ca href=\"#install-redis\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EInstall Redis\u003C\u002Fh3\u003E\u003Cp\u003ELet’s now create a redis container to use as a cache memory.\u003C\u002Fp\u003E\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F2070\u002F1*t1rRZ0mydVzd9isqqVxMfQ.png\" alt=\"Create a redis container\"\u003E\u003Cem\u003ECreate a redis container\u003C\u002Fem\u003E\u003C\u002Fp\u003E\u003Cp\u003EAttach the container to the php network and to persist our data we can use the db-data volume and mapped it to \u002Fvar\u002Flib\u002Fredis directory of docker host. Finally add a command in the command tab to run redis with appendonly mode and create the container\u003C\u002Fp\u003E\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F2414\u002F1*pp9X1Yeb9d75FyHK3J2_9Q.png\" alt=\"Add a command to run redis with appendonly mode\"\u003E\u003Cem\u003EAdd a command to run redis with appendonly mode\u003C\u002Fem\u003E\u003C\u002Fp\u003E\u003Cp\u003ENow we need to configure our .env file in our application\u003C\u002Fp\u003E\u003Cpre class=\"language-text\"\u003E\u003Ccode class=\"language-text\"\u003ECACHE_DRIVER=redis\n\nREDIS_HOST=redis\nREDIS_PASSWORD=null\nREDIS_PORT=6379\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003ECache driver will be redis and redis host name is the name of our container which is redis. We’ll also need to predis\u002Fpredis package to use redis in our application. So connect to the php container bash terminal and install the package\u003C\u002Fp\u003E\u003Cpre class=\"language-text\"\u003E\u003Ccode class=\"language-text\"\u003E$ composer require predis\u002Fpredis\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EAfter predis has been installed let’s check it’s working. We’ll add to route to our routes file, one for putting a value in the cache and one to get the value, so add the below code in the routes\u002Fweb.php file\u003C\u002Fp\u003E\u003Cpre class=\"language-text\"\u003E\u003Ccode class=\"language-text\"\u003ERoute::get(&#39;get&#39;, function() {\n    return \\Illuminate\\Support\\Facades\\Cache::get(&#39;hello&#39;);\n});\n\nRoute::get(&#39;put&#39;, function() {\n    return \\Illuminate\\Support\\Facades\\Cache::put(&#39;hello&#39;, &#39;world&#39;, 5);\n});\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003ENow first visit the put routes to put world as a value of hello key. It’ll return nothing but if we now visit the get route we’ll see it retrieve the value of hello key from the cache and return it to us.\u003C\u002Fp\u003E\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F2640\u002F1*OMac2ow4KGEYNoE2ug04og.png\" alt=\"Checking our redis container is working\"\u003E\u003Cem\u003EChecking our redis container is working\u003C\u002Fem\u003E\u003C\u002Fp\u003E\u003C\u002Fsection\u003E\n\u003Csection\u003E\u003Ch3 id=\"conclusion\"\u003E\u003Ca href=\"#conclusion\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EConclusion\u003C\u002Fh3\u003E\u003Cp\u003ESo we have added few more containers and our machine is ready to build awesome applications with laravel.\u003C\u002Fp\u003E\u003Cp\u003EIn next post we’ll see how we can use different PHP versions and databases to test our application without messing with our host machine.\u003C\u002Fp\u003E\u003Cp\u003EIf you liked the content please consider to share the knowledge and don’t forget to subscribe for more.\u003C\u002Fp\u003E\u003Cp\u003E\u003Ca href=\"\u002Flocal-development-environment-with-docker-for-php\"\u003EPart-1\u003C\u002Fa\u003E\u003C\u002Fp\u003E\u003Cp\u003E\u003Ca href=\"\u002Flocal-development-environment-with-docker-for-php-3\"\u003EPart-3\u003C\u002Fa\u003E\u003C\u002Fp\u003E\u003C\u002Fsection\u003E\n","timeToRead":4}},"context":{}};(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());</script><script src="/assets/js/app.8e2879ca.js" defer></script><script src="/assets/js/page--src--templates--blog-post-vue.725efc4f.js" defer></script>

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-61716953-3"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'UA-61716953-3');
    </script>
</body>

</html>
<!DOCTYPE html>
<html data-html-server-rendered="true" lang="en" data-vue-tag="%7B%22lang%22:%7B%22ssr%22:%22en%22%7D%7D">
  <head>
    <title>Local Development Environment with Docker for PHP - Nehal Hasnayeen</title><meta name="gridsome:hash" content="359924f4c9b994cdac1b3e3ad792e6dccc460f17"><meta data-vue-tag="ssr" charset="utf-8"><meta data-vue-tag="ssr" name="generator" content="Gridsome v0.7.8"><meta data-vue-tag="ssr" data-key="viewport" name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"><meta data-vue-tag="ssr" data-key="format-detection" name="format-detection" content="telephone=no"><link data-vue-tag="ssr" rel="icon" href="data:,"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="16x16" href="/assets/static/favicon.ce0531f.cb378d4.png"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="32x32" href="/assets/static/favicon.ac8d93a.cb378d4.png"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="96x96" href="/assets/static/favicon.b9532cc.cb378d4.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="76x76" href="/assets/static/favicon.f22e9f3.cb378d4.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="152x152" href="/assets/static/favicon.62d22cb.cb378d4.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="120x120" href="/assets/static/favicon.1539b60.cb378d4.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="167x167" href="/assets/static/favicon.dc0cdc5.cb378d4.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="180x180" href="/assets/static/favicon.7b22250.cb378d4.png"><noscript data-vue-tag="ssr"><style>.g-image--loading{display:none;}</style></noscript><link rel="preload" href="/assets/css/0.styles.2de9f300.css" as="style"><link rel="preload" href="/assets/js/app.b5f97140.js" as="script"><link rel="preload" href="/assets/js/page--src--templates--blog-post-vue.f08fc299.js" as="script"><link rel="prefetch" href="/assets/js/page--node-modules--gridsome--app--pages--404-vue.d8abca37.js"><link rel="prefetch" href="/assets/js/page--src--pages--about-vue.ceda61a0.js"><link rel="prefetch" href="/assets/js/page--src--pages--blog-vue.4f62559f.js"><link rel="prefetch" href="/assets/js/page--src--pages--bn--eli5-vue.4e699466.js"><link rel="prefetch" href="/assets/js/page--src--pages--contacts-vue.12290d8d.js"><link rel="prefetch" href="/assets/js/page--src--pages--credits-vue.c96aa73f.js"><link rel="prefetch" href="/assets/js/page--src--pages--hire-me-vue.036683be.js"><link rel="prefetch" href="/assets/js/page--src--pages--index-vue.1b0bf385.js"><link rel="prefetch" href="/assets/js/page--src--pages--projects-vue.b7de8cd2.js"><link rel="prefetch" href="/assets/js/page--src--pages--reading-vue.6647c773.js"><link rel="prefetch" href="/assets/js/page--src--templates--eli5-post-vue.5d8198fa.js"><link rel="prefetch" href="/assets/js/page--src--templates--now-page-vue.ba3337c3.js"><link rel="stylesheet" href="/assets/css/0.styles.2de9f300.css">
  </head>
  <body class="bg-indigo-100 font-display overflow-x-hidden" data-vue-tag="%7B%22class%22:%7B%22ssr%22:%22bg-indigo-100%20font-display%20overflow-x-hidden%22%7D%7D">
    <div data-server-rendered="true" id="app" class="text-gray-800 flex flex-col h-screen max-w-6xl mx-auto" data-v-a12462e6><header class="lg:py-4 lg:px-16 flex justify-between items-center"><div class="overflow-hidden h-16"><a href="/" class="active"><img alt="logo" src="data:image/svg+xml,%3csvg fill='none' viewBox='0 0 300 300' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cdefs%3e%3cfilter id='__svg-blur-1'%3e%3cfeGaussianBlur in='SourceGraphic' stdDeviation='40'/%3e%3c/filter%3e%3c/defs%3e%3cimage x='0' y='0' filter='url(%23__svg-blur-1)' width='300' height='300' xlink:href='data:image/svg%2bxml%3bbase64%2ciVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAACXBIWXMAAAsTAAALEwEAmpwYAAADn0lEQVR42u2X3UsUURjGd2ZXXS0zySKNCEsr0ezLyLSyIsxK3VlLJcoMNEj7UuyDxBS3rEQjJcpKLN3ZdTMJpIv6A7zptuu6jO66CSxdrek5u%2b/UuJjmpkH2PvDjnJ1z5px5v87MmkwsFovFYrFYLBaLxWKxWCwWi8VisViTS2Kjx0v%2b35yRDJb8hoPmVKYkyCFWK/XrZEtoluiYQ8OFIwrnZGkoLu%2bP9JYtYcdhXwMNXQGbqH/VP%2bYvhYXxacYlUkAoOcaIbHCYbCgjaZK5ge1E60w0Pzjl9mi%2bNnJZkim1pE0yGB4G4jIvv9xV8FRLXrB83Wn9np0Ng8YMsACVHPCPRd7zxaSovuibCnq/%2bYyyu78WH%2brTWvO7h9TD/drdAo/mUJwj7cUD2jW7a6wmp%2bODpWVIM22udBrrvxuUiJIBMZQ1B8BemrMGVIFEcBTYQCOIp2tibjb9zqN7jpBzD4KTdC0diECsBWXisWlPa1AOsKujfkeoXjP9tivqSL3iHC6CsQP5jz9tzH30cb7iGm2ydX8%2bh7FyzK0Vc/ffe282LNUHVoAz4ARRCVwgCbjJQZGgn67ZQQ21p4BHLAuaac0OcsxqcBtsByvBdZBD60g0lhF0OegZYHMPm9F/AeL2ON5IAWdEJK4nggQwCMTDmDQN5SPJwhFdNFVErx5kUtQ9FK1ScJ8c00IRE9F0UORjgZMMrqe1mul%2bPYtuUdRDKGvu0PVa2m/6DrDDeBgjkyPqADLAG2NwzmJQDUp9812jwkkpwJf/C2JX6VPbQZQ4HsAl0EqpKx76GLUi9beQA4Rz1gNx2DbR28VB91yktpPKpocMVMBzyhiRQQ9p7wqQH5QDFJQAjJHI2BawDTSDAkQ9TRgOXovoG5yyG/SKfnbbOz1TrLS5/gCLKF312hRpnEr9eXTAyhTNcMoSUe9LqXSEsdWGe6OpL8osjvpR1IbQekEcgm5DBri8Gei/BYVk6DNkiG8zmzpixe99oB9UgSf6GhvKHkxny6kiJIwpB0UgImDMPGsfXjj8JCoJUeedoAL0wSldSPsd6N8EN0AjaAOvwHl6a5jxsTTVJ7U0xUNPNi7NmuHiA8iujunloJ8FESCL6l8YfxZsNZRANLgA0um3pPQMz%2bRjmf/qfw7xFvjpBO8vN0YmyHCYJeDeufFJrPjfBsa%2b7IusvxUnv5TnHDduNhyephnOABaLxWKxWCwWi8VisVgsFovFYrFYrD/Sd3quS0gVhIbmAAAAAElFTkSuQmCC' /%3e%3c/svg%3e" width="300" data-src="/assets/static/logo.6b65613.b0e31d1.svg" data-srcset="/assets/static/logo.6b65613.b0e31d1.svg 300w" data-sizes="(max-width: 300px) 100vw, 300px" class="h-64 -mt-24 -ml-8 g-image g-image--lazy g-image--loading"><noscript><img src="/assets/static/logo.6b65613.b0e31d1.svg" class="h-64 -mt-24 -ml-8 g-image g-image--loaded" width="300" alt="logo"></noscript></a></div><div><div class="pr-2 cursor-pointer lg:hidden"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-8"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg></div><nav class="flex items-center"><div class="hidden lg:flex items-center"><a href="/about" class="font-semibold mr-8">About</a><a href="/now" class="font-semibold mr-8">Now</a><div class="mr-8"><div id="series-menu" class="font-semibold cursor-default">More</div><div id="series-dropdown" class="absolute pt-4 -ml-16"><div class="w-2 h-2 mt-3 ml-20 bg-indigo-600 absolute top-0 arrow"></div><div class="bg-indigo-600 rounded-lg shadow py-4 flex flex-col w-48"><a href="/projects" class="font-semibold px-8 py-2 text-white hover:text-indigo-600 hover:bg-white">Projects</a><a href="/blog" class="font-semibold px-8 py-2 text-white hover:text-indigo-600 hover:bg-white">Blog</a><div class="border-t px-8 pt-4 pb-2 text-orange-400 text-sm font-semibold">Series</div><a href="/bn/eli5" class="font-semibold px-8 py-2 text-white hover:text-indigo-600 hover:bg-white">Eli5 (বাংলা)</a></div></div></div><a href="/hire-me" class="font-extrabold uppercase bg-indigo-600 text-white px-4 py-2 rounded">Hire Me</a></div><!----></nav></div></header><main class="flex-grow pt-8 mx-4 md:mx-16"><div data-v-a12462e6><div class="max-w-4xl container text-gray-800 bg-white px-4 lg:px-24 py-8 lg:py-16 rounded-lg shadow-xl" data-v-a12462e6><div class="text-center" data-v-a12462e6><span class="border-b border-indigo-600 pb-1" data-v-a12462e6>
          May 26, 2017
        </span></div><div class="text-center pb-4 pt-1" data-v-a12462e6><span data-v-a12462e6>
          6 min read
        </span></div><h1 class="text-2xl md:text-4xl text-indigo-600 pb-4 text-center" data-v-a12462e6>Local Development Environment with Docker for PHP</h1><div class="md:text-lg leading-relaxed blog" data-v-a12462e6><p><strong><em>Setting Docker, Portainer, Nginx, PHP and Composer</em></strong></p>
<p>If you work with different language, tools or technology its really hard some time to manage all these different environments in local machine. Docker is a great tool which give us isolated environment to build our application with required tools and libraries without messing with the host machine. You can package up an application with all of the parts it needs, such as libraries and other dependencies, and run it on any machine which have docker installed without installing a single piece of software. You can use different version of any tools separately without any hassle. So let’s see how can we use docker to setup our development environment to build application with Laravel.</p>
<section><h3 id="install-docker"><a href="#install-docker" aria-hidden="true"><span class="icon icon-link"></span></a>Install docker</h3><p>I’m using antergos which is arch-linux based os, so installation instructions step below are for arch-linux distro. If you are on Mac or Windows or any other linux distro visit <a href="https://www.docker.com/community-edition#download" target="_blank" rel="nofollow noopener noreferrer">here</a> for installation instruction.</p><pre class="language-text"><code class="language-text">$ sudo pacman -S docker</code></pre><p>To start the docker service (for any linux OS that use systemctl)</p><pre class="language-text"><code class="language-text">$ sudo systemctl start docker.service</code></pre><p>To start on system boot</p><pre class="language-text"><code class="language-text">$ sudo systemctl enable docker.service</code></pre></section>
<section><h3 id="install-portainer"><a href="#install-portainer" aria-hidden="true"><span class="icon icon-link"></span></a>Install Portainer</h3><p>Portainer is a container which gives a nice ui dashboard to use docker easily. We’ll create and run the portainer container like below</p><pre class="language-text"><code class="language-text">$ sudo docker run -d --name portainer -p 80:9000 -v /var/run/docker.sock:/var/run/docker.sock portainer/portainer</code></pre><p>Above will create a container from portainer image and then run it in background ( -d flag make the container run in background). The command will search for the portainer image in local machine and if it doesn’t find the image then it will pull the image from docker image registry. We’ll run the container in port 9000 so port 9000 should be available, but if you want to use any other port than specify it via the -p flag ( -p 8080:9000 ). Also notice that we have named our container portainer with — name flag. You can name your container whatever you want. When the download is complete we can check that the container is running by $ docker ps command. It’ll show a list of all the running container</p><pre class="language-text"><code class="language-text">CONTAINER ID        IMAGE                 COMMAND             CREATED             STATUS              PORTS                    NAMES
1f5bb115d327        portainer/portainer   &quot;/portainer&quot;        5 seconds ago         Up 1 second         0.0.0.0:9000-&gt;9000/tcp   portainer</code></pre><p>Now you can visit the dashboard by visiting localhost in your browser. You’ll see below screen</p><p><img src="https://cdn-images-1.medium.com/max/2644/1*IiMm3jKgkKHpoWUXMdQCSg.png"></p><p>Provide a password for admin user account and then login to the dashboard. You’ll see a screen like below.</p><p><img src="https://cdn-images-1.medium.com/max/2648/1*WkN1z_PM0cHqNpD_tJzLKw.png"></p><p>Select the first one and connect, you’ll see a nice dashboard</p><p><img src="https://cdn-images-1.medium.com/max/2642/1*iiMMDvavsXI1S_KdvrWQIA.png"></p></section>
<section><h3 id="create-a-php-network"><a href="#create-a-php-network" aria-hidden="true"><span class="icon icon-link"></span></a>Create a PHP network</h3><p>First we will create a network for php application only. Click the network menu from sidebar and then give it some name like php and click create.</p><p><img src="https://cdn-images-1.medium.com/max/2482/1*cVDl1WRrjx5lpluCRpt1Ug.png" alt="Create a php network"><em>Create a php network</em></p></section>
<section><h3 id="install-nginx"><a href="#install-nginx" aria-hidden="true"><span class="icon icon-link"></span></a>Install Nginx</h3><p>First we will create a container as our server and we’ll use official nginx image from docker hub. Go to Containers page from sidebar menu and click on Add Container button</p><p><img src="https://cdn-images-1.medium.com/max/2646/1*FjabcxJNQtHKD9dgtrP27w.png" alt="Add New Container"><em>Add New Container</em></p><p>Let’s give our container a name of server and the image name which is nginx. Click the publish all exposed ports which’ll expose port 80. Next click map additional port and map our host machine port 80 to container port 80 like below</p><p><img src="https://cdn-images-1.medium.com/max/2072/1*LbOqkYrRA3RlEBiMyIMwLA.png" alt="Map host port 80 to container port 80"><em>Map host port 80 to container port 80</em></p><p>Next create two folders where you will keep your projects. This can be anywhere in your file system. One folders is to keep our application source code and the other is for nginx configuration.</p><p><img src="https://cdn-images-1.medium.com/max/2000/1*ZUYYe0X6Psy8NsqtuhDJFw.png"></p><p>Now under Advanced Container Settings click the volume tab and bind sites directory to /var/www in container and nginx-conf directory to /etc/nginx/conf.d .</p><p><img src="https://cdn-images-1.medium.com/max/2432/1*TWBD6U3WvslSYpjjZegxFw.png"></p><p>Next select the php network we created earlier in network tab. Finally hit the start container button. First portainer will pull the nginx image from registry and then start the container</p><p><img src="https://cdn-images-1.medium.com/max/2090/1*qyle5bNsvQaeVH1BOEV2sA.png"></p></section>
<section><h3 id="install-php-fpm"><a href="#install-php-fpm" aria-hidden="true"><span class="icon icon-link"></span></a>Install PHP-FPM</h3><p>Next we will install php fpm to serve our php application. We’ll create a container using official php-fpm image.</p><p><img src="https://cdn-images-1.medium.com/max/2478/1*tBMvHo1vmNVLAnSvoq3GPA.png"></p><p>We don’t need to bind any port from our host machine to the container, nginx will send traffic to php-fpm, we just need to select the php network in network tab.</p><p><img src="https://cdn-images-1.medium.com/max/2418/1*iMBk3-YUMDOonZCqoG1HVA.png"></p><p>Also we need to map our sites directory to the /var/www directory in the container.</p><p><img src="https://cdn-images-1.medium.com/max/2410/1*oUUX9GcaQLH48ZOIoGX1aw.png"></p><p>Finally in Command tabs put /var/www as value in Working Dir field</p><p><img src="https://cdn-images-1.medium.com/max/2414/1*o67Xa35i5hib1OqrYv6i6Q.png"></p><p>Now start the container by hitting start container button.</p><p><img src="https://cdn-images-1.medium.com/max/2646/1*pMM_WxHLiE8mnpVzrTbkNg.png"></p></section>
<section><h3 id="add-application"><a href="#add-application" aria-hidden="true"><span class="icon icon-link"></span></a>Add Application</h3><p>Let’s try to add our first php website. First add a hello.conf file inside nginx-conf directory with below contents</p><pre class="language-text"><code class="language-text">server {
    listen 80;

    server_name hello.local;

    client_max_body_size 108M;

    access_log /var/log/nginx/hello.access.log;
    error_log /var/log/nginx/hello.error.log;

    root /var/www/hello/public;
    index index.php;

    if (!-e $request_filename) {
        rewrite ^.*$ /index.php last;
    }

    location ~ \.php$ {
        fastcgi_pass php:9000;
        fastcgi_index index.php;
        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
        fastcgi_param PHP_VALUE &quot;error_log=/var/log/nginx/hello-php.log&quot;;
        fastcgi_buffers 16 16k;
        fastcgi_buffer_size 32k;
        include fastcgi_params;
    }
}</code></pre><p>This file is for routing traffic to php-fpm. Next add a index.php file inside sites/hello/public directory with following contents</p><pre class="language-text"><code class="language-text">&lt;?php
phpinfo();</code></pre><p>And finally add a domain for our site in /etc/hosts file</p><pre class="language-text"><code class="language-text">127.0.0.1    hello.local</code></pre><p>Now visit <a href="http://hello.local" target="_blank" rel="nofollow noopener noreferrer">http://hello.local</a> and you’ll see</p><p><img src="https://cdn-images-1.medium.com/max/2644/1*VGJciA8oO9v10HDGF6aAQQ.png"></p><p>Now let’s add another site, the procedure is same. First we add conf file for nginx configuration and then add our code in a directory under sites and finally add a domain for that site in /etc/hosts file.</p></section>
<section><h3 id="install-php-extensions"><a href="#install-php-extensions" aria-hidden="true"><span class="icon icon-link"></span></a>Install PHP Extensions</h3><p>By default only few extensions are installed in the container. If we want we can install more extensions. First let’s connect to the bash terminal of our php container. If you visit the container page you’ll see a console link, click it</p><p><img src="https://cdn-images-1.medium.com/max/2406/1*skgNxzuS_2Si_UlyrCbR9A.png"></p><p>You’ll see a connect button to connect to the bash, click it and you’ll be at /var/www directory.</p><p><img src="https://cdn-images-1.medium.com/max/2642/1*3t0MU2VcAo_wHjgwZ6z9-g.png"></p><p>Now let’s install pdo_mysql extension to use mysql pdo driver by following command</p><pre class="language-text"><code class="language-text">$ docker-php-ext-install pdo_mysql</code></pre><p>We’ll also install <code class="language-text">gd</code> and <code class="language-text">ext-zip</code> extensions</p><pre class="language-text"><code class="language-text">$ docker-php-ext-configure gd --with-freetype-dir=/usr/include/ --with-jpeg-dir=/usr/include/ &amp;&amp; docker-php-ext-install gd

$ apt-get install libzip-dev &amp;&amp; docker-php-ext-install zip</code></pre><p>You can install other extensions in similar way. After installing any extension restart the container.</p></section>
<section><h3 id="install-composer"><a href="#install-composer" aria-hidden="true"><span class="icon icon-link"></span></a>Install Composer</h3><p>Before we install composer first install zip &#x26; unzip package which’ll be used by composer for laravel installation.</p><pre class="language-text"><code class="language-text">$ apt-get update &amp;&amp; apt-get install zip unzip</code></pre><p>And now install composer</p><pre class="language-text"><code class="language-text">$ curl -sS [https://getcomposer.org/installer](https://getcomposer.org/installer) | php -- --install-dir=/usr/bin/ --filename=composer</code></pre><p>Let’s check composer is installed and in our path</p><pre class="language-text"><code class="language-text">$ composer --version
Composer version 1.4.2 2017-03-10 09:29:45</code></pre></section>
<section><h3 id="install-laravel"><a href="#install-laravel" aria-hidden="true"><span class="icon icon-link"></span></a>Install Laravel</h3><p>Lets install our first laravel application by running following command</p><pre class="language-text"><code class="language-text">$ composer create-project --prefer-dist laravel/laravel example</code></pre><p>It’ll create a new laravel app inside example directory. To make it accessible we have to create a example.conf and add example.local domain in /etc/hosts file. Also we need to change the owner of storage and boostrap folder like below</p><pre class="language-text"><code class="language-text">$ chown -R www-data:www-data storage bootstrap</code></pre><p>Now if we visit example.local in the browser we’ll see</p><p><img src="https://cdn-images-1.medium.com/max/2648/1*0LLdZWXfbqAz8xUi8PomHA.png"></p><p>Adding another application will be same as before: 1) create a new laravel app inside sites directory, 2) add a new .conf file for that application, 3) add a domain in /etc/hosts 4) change owner of storage and bootstrap folder to www-data .</p></section>
<section><h3 id="conclusion"><a href="#conclusion" aria-hidden="true"><span class="icon icon-link"></span></a>Conclusion</h3><p>We have one piece of the puzzle still left, that is database. We’ll see in next post how to add any database to our application and persist the data and also some other tools like redis etc. We’ll also see how can we use another php version to test the same application. Stay tuned!</p><section><h4 id="part-2"><a href="#part-2" aria-hidden="true"><span class="icon icon-link"></span></a><a href="/local-development-environment-with-docker-for-php-2">Part-2</a></h4></section></section>
</div></div><div class="bg-white rounded-lg shadow-xl mt-16 mx-auto px-4 lg:px-24 py-8 lg:py-16 max-w-4xl" data-v-a12462e6><div data-v-a12462e6><div class="text-xl font-semibold" data-v-a12462e6>
          Comments:
        </div><div data-v-a12462e6>
          If you found any error or have any suggestion let me know in the comments.
        </div></div><script src="https://utteranc.es/client.js" repo="Hasnayeen/hasnayeen.github.io" issue-term="title" label="comments" theme="github-light" crossorigin="anonymous" async="async" data-v-a12462e6></script></div></div></main><footer class="mt-16 py-4 px-4 lg:px-16 flex flex-col lg:flex-row-reverse bg-indigo-700 lg:bg-transparent justify-between text-white lg:text-gray-800"><div><a href="/credits" class="lg:text-indigo-700 font-semibold mr-12">Credits</a><a href="/contacts" class="lg:text-indigo-700 font-semibold">Contacts</a></div><div class="text-sm lg:text-base">
      Copyright © 2019 hasnayeen.dev. All rights reserved.
    </div></footer></div>
    <script>window.__INITIAL_STATE__={"data":{"blogPost":{"id":"2b8ea4e6881389fcb72c0f248475f19a","title":"Local Development Environment with Docker for PHP","date":"May 26, 2017","content":"\u003Cp\u003E\u003Cstrong\u003E\u003Cem\u003ESetting Docker, Portainer, Nginx, PHP and Composer\u003C\u002Fem\u003E\u003C\u002Fstrong\u003E\u003C\u002Fp\u003E\n\u003Cp\u003EIf you work with different language, tools or technology its really hard some time to manage all these different environments in local machine. Docker is a great tool which give us isolated environment to build our application with required tools and libraries without messing with the host machine. You can package up an application with all of the parts it needs, such as libraries and other dependencies, and run it on any machine which have docker installed without installing a single piece of software. You can use different version of any tools separately without any hassle. So let’s see how can we use docker to setup our development environment to build application with Laravel.\u003C\u002Fp\u003E\n\u003Csection\u003E\u003Ch3 id=\"install-docker\"\u003E\u003Ca href=\"#install-docker\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EInstall docker\u003C\u002Fh3\u003E\u003Cp\u003EI’m using antergos which is arch-linux based os, so installation instructions step below are for arch-linux distro. If you are on Mac or Windows or any other linux distro visit \u003Ca href=\"https:\u002F\u002Fwww.docker.com\u002Fcommunity-edition#download\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003Ehere\u003C\u002Fa\u003E for installation instruction.\u003C\u002Fp\u003E\u003Cpre class=\"language-text\"\u003E\u003Ccode class=\"language-text\"\u003E$ sudo pacman -S docker\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003ETo start the docker service (for any linux OS that use systemctl)\u003C\u002Fp\u003E\u003Cpre class=\"language-text\"\u003E\u003Ccode class=\"language-text\"\u003E$ sudo systemctl start docker.service\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003ETo start on system boot\u003C\u002Fp\u003E\u003Cpre class=\"language-text\"\u003E\u003Ccode class=\"language-text\"\u003E$ sudo systemctl enable docker.service\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fsection\u003E\n\u003Csection\u003E\u003Ch3 id=\"install-portainer\"\u003E\u003Ca href=\"#install-portainer\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EInstall Portainer\u003C\u002Fh3\u003E\u003Cp\u003EPortainer is a container which gives a nice ui dashboard to use docker easily. We’ll create and run the portainer container like below\u003C\u002Fp\u003E\u003Cpre class=\"language-text\"\u003E\u003Ccode class=\"language-text\"\u003E$ sudo docker run -d --name portainer -p 80:9000 -v \u002Fvar\u002Frun\u002Fdocker.sock:\u002Fvar\u002Frun\u002Fdocker.sock portainer\u002Fportainer\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EAbove will create a container from portainer image and then run it in background ( -d flag make the container run in background). The command will search for the portainer image in local machine and if it doesn’t find the image then it will pull the image from docker image registry. We’ll run the container in port 9000 so port 9000 should be available, but if you want to use any other port than specify it via the -p flag ( -p 8080:9000 ). Also notice that we have named our container portainer with — name flag. You can name your container whatever you want. When the download is complete we can check that the container is running by $ docker ps command. It’ll show a list of all the running container\u003C\u002Fp\u003E\u003Cpre class=\"language-text\"\u003E\u003Ccode class=\"language-text\"\u003ECONTAINER ID        IMAGE                 COMMAND             CREATED             STATUS              PORTS                    NAMES\n1f5bb115d327        portainer\u002Fportainer   &quot;\u002Fportainer&quot;        5 seconds ago         Up 1 second         0.0.0.0:9000-&gt;9000\u002Ftcp   portainer\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003ENow you can visit the dashboard by visiting localhost in your browser. You’ll see below screen\u003C\u002Fp\u003E\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F2644\u002F1*IiMm3jKgkKHpoWUXMdQCSg.png\"\u003E\u003C\u002Fp\u003E\u003Cp\u003EProvide a password for admin user account and then login to the dashboard. You’ll see a screen like below.\u003C\u002Fp\u003E\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F2648\u002F1*WkN1z_PM0cHqNpD_tJzLKw.png\"\u003E\u003C\u002Fp\u003E\u003Cp\u003ESelect the first one and connect, you’ll see a nice dashboard\u003C\u002Fp\u003E\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F2642\u002F1*iiMMDvavsXI1S_KdvrWQIA.png\"\u003E\u003C\u002Fp\u003E\u003C\u002Fsection\u003E\n\u003Csection\u003E\u003Ch3 id=\"create-a-php-network\"\u003E\u003Ca href=\"#create-a-php-network\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003ECreate a PHP network\u003C\u002Fh3\u003E\u003Cp\u003EFirst we will create a network for php application only. Click the network menu from sidebar and then give it some name like php and click create.\u003C\u002Fp\u003E\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F2482\u002F1*cVDl1WRrjx5lpluCRpt1Ug.png\" alt=\"Create a php network\"\u003E\u003Cem\u003ECreate a php network\u003C\u002Fem\u003E\u003C\u002Fp\u003E\u003C\u002Fsection\u003E\n\u003Csection\u003E\u003Ch3 id=\"install-nginx\"\u003E\u003Ca href=\"#install-nginx\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EInstall Nginx\u003C\u002Fh3\u003E\u003Cp\u003EFirst we will create a container as our server and we’ll use official nginx image from docker hub. Go to Containers page from sidebar menu and click on Add Container button\u003C\u002Fp\u003E\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F2646\u002F1*FjabcxJNQtHKD9dgtrP27w.png\" alt=\"Add New Container\"\u003E\u003Cem\u003EAdd New Container\u003C\u002Fem\u003E\u003C\u002Fp\u003E\u003Cp\u003ELet’s give our container a name of server and the image name which is nginx. Click the publish all exposed ports which’ll expose port 80. Next click map additional port and map our host machine port 80 to container port 80 like below\u003C\u002Fp\u003E\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F2072\u002F1*LbOqkYrRA3RlEBiMyIMwLA.png\" alt=\"Map host port 80 to container port 80\"\u003E\u003Cem\u003EMap host port 80 to container port 80\u003C\u002Fem\u003E\u003C\u002Fp\u003E\u003Cp\u003ENext create two folders where you will keep your projects. This can be anywhere in your file system. One folders is to keep our application source code and the other is for nginx configuration.\u003C\u002Fp\u003E\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F2000\u002F1*ZUYYe0X6Psy8NsqtuhDJFw.png\"\u003E\u003C\u002Fp\u003E\u003Cp\u003ENow under Advanced Container Settings click the volume tab and bind sites directory to \u002Fvar\u002Fwww in container and nginx-conf directory to \u002Fetc\u002Fnginx\u002Fconf.d .\u003C\u002Fp\u003E\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F2432\u002F1*TWBD6U3WvslSYpjjZegxFw.png\"\u003E\u003C\u002Fp\u003E\u003Cp\u003ENext select the php network we created earlier in network tab. Finally hit the start container button. First portainer will pull the nginx image from registry and then start the container\u003C\u002Fp\u003E\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F2090\u002F1*qyle5bNsvQaeVH1BOEV2sA.png\"\u003E\u003C\u002Fp\u003E\u003C\u002Fsection\u003E\n\u003Csection\u003E\u003Ch3 id=\"install-php-fpm\"\u003E\u003Ca href=\"#install-php-fpm\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EInstall PHP-FPM\u003C\u002Fh3\u003E\u003Cp\u003ENext we will install php fpm to serve our php application. We’ll create a container using official php-fpm image.\u003C\u002Fp\u003E\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F2478\u002F1*tBMvHo1vmNVLAnSvoq3GPA.png\"\u003E\u003C\u002Fp\u003E\u003Cp\u003EWe don’t need to bind any port from our host machine to the container, nginx will send traffic to php-fpm, we just need to select the php network in network tab.\u003C\u002Fp\u003E\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F2418\u002F1*iMBk3-YUMDOonZCqoG1HVA.png\"\u003E\u003C\u002Fp\u003E\u003Cp\u003EAlso we need to map our sites directory to the \u002Fvar\u002Fwww directory in the container.\u003C\u002Fp\u003E\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F2410\u002F1*oUUX9GcaQLH48ZOIoGX1aw.png\"\u003E\u003C\u002Fp\u003E\u003Cp\u003EFinally in Command tabs put \u002Fvar\u002Fwww as value in Working Dir field\u003C\u002Fp\u003E\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F2414\u002F1*o67Xa35i5hib1OqrYv6i6Q.png\"\u003E\u003C\u002Fp\u003E\u003Cp\u003ENow start the container by hitting start container button.\u003C\u002Fp\u003E\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F2646\u002F1*pMM_WxHLiE8mnpVzrTbkNg.png\"\u003E\u003C\u002Fp\u003E\u003C\u002Fsection\u003E\n\u003Csection\u003E\u003Ch3 id=\"add-application\"\u003E\u003Ca href=\"#add-application\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EAdd Application\u003C\u002Fh3\u003E\u003Cp\u003ELet’s try to add our first php website. First add a hello.conf file inside nginx-conf directory with below contents\u003C\u002Fp\u003E\u003Cpre class=\"language-text\"\u003E\u003Ccode class=\"language-text\"\u003Eserver {\n    listen 80;\n\n    server_name hello.local;\n\n    client_max_body_size 108M;\n\n    access_log \u002Fvar\u002Flog\u002Fnginx\u002Fhello.access.log;\n    error_log \u002Fvar\u002Flog\u002Fnginx\u002Fhello.error.log;\n\n    root \u002Fvar\u002Fwww\u002Fhello\u002Fpublic;\n    index index.php;\n\n    if (!-e $request_filename) {\n        rewrite ^.*$ \u002Findex.php last;\n    }\n\n    location ~ \\.php$ {\n        fastcgi_pass php:9000;\n        fastcgi_index index.php;\n        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;\n        fastcgi_param PHP_VALUE &quot;error_log=\u002Fvar\u002Flog\u002Fnginx\u002Fhello-php.log&quot;;\n        fastcgi_buffers 16 16k;\n        fastcgi_buffer_size 32k;\n        include fastcgi_params;\n    }\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EThis file is for routing traffic to php-fpm. Next add a index.php file inside sites\u002Fhello\u002Fpublic directory with following contents\u003C\u002Fp\u003E\u003Cpre class=\"language-text\"\u003E\u003Ccode class=\"language-text\"\u003E&lt;?php\nphpinfo();\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EAnd finally add a domain for our site in \u002Fetc\u002Fhosts file\u003C\u002Fp\u003E\u003Cpre class=\"language-text\"\u003E\u003Ccode class=\"language-text\"\u003E127.0.0.1    hello.local\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003ENow visit \u003Ca href=\"http:\u002F\u002Fhello.local\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003Ehttp:\u002F\u002Fhello.local\u003C\u002Fa\u003E and you’ll see\u003C\u002Fp\u003E\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F2644\u002F1*VGJciA8oO9v10HDGF6aAQQ.png\"\u003E\u003C\u002Fp\u003E\u003Cp\u003ENow let’s add another site, the procedure is same. First we add conf file for nginx configuration and then add our code in a directory under sites and finally add a domain for that site in \u002Fetc\u002Fhosts file.\u003C\u002Fp\u003E\u003C\u002Fsection\u003E\n\u003Csection\u003E\u003Ch3 id=\"install-php-extensions\"\u003E\u003Ca href=\"#install-php-extensions\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EInstall PHP Extensions\u003C\u002Fh3\u003E\u003Cp\u003EBy default only few extensions are installed in the container. If we want we can install more extensions. First let’s connect to the bash terminal of our php container. If you visit the container page you’ll see a console link, click it\u003C\u002Fp\u003E\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F2406\u002F1*skgNxzuS_2Si_UlyrCbR9A.png\"\u003E\u003C\u002Fp\u003E\u003Cp\u003EYou’ll see a connect button to connect to the bash, click it and you’ll be at \u002Fvar\u002Fwww directory.\u003C\u002Fp\u003E\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F2642\u002F1*3t0MU2VcAo_wHjgwZ6z9-g.png\"\u003E\u003C\u002Fp\u003E\u003Cp\u003ENow let’s install pdo_mysql extension to use mysql pdo driver by following command\u003C\u002Fp\u003E\u003Cpre class=\"language-text\"\u003E\u003Ccode class=\"language-text\"\u003E$ docker-php-ext-install pdo_mysql\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EWe’ll also install \u003Ccode class=\"language-text\"\u003Egd\u003C\u002Fcode\u003E and \u003Ccode class=\"language-text\"\u003Eext-zip\u003C\u002Fcode\u003E extensions\u003C\u002Fp\u003E\u003Cpre class=\"language-text\"\u003E\u003Ccode class=\"language-text\"\u003E$ docker-php-ext-configure gd --with-freetype-dir=\u002Fusr\u002Finclude\u002F --with-jpeg-dir=\u002Fusr\u002Finclude\u002F &amp;&amp; docker-php-ext-install gd\n\n$ apt-get install libzip-dev &amp;&amp; docker-php-ext-install zip\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EYou can install other extensions in similar way. After installing any extension restart the container.\u003C\u002Fp\u003E\u003C\u002Fsection\u003E\n\u003Csection\u003E\u003Ch3 id=\"install-composer\"\u003E\u003Ca href=\"#install-composer\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EInstall Composer\u003C\u002Fh3\u003E\u003Cp\u003EBefore we install composer first install zip &#x26; unzip package which’ll be used by composer for laravel installation.\u003C\u002Fp\u003E\u003Cpre class=\"language-text\"\u003E\u003Ccode class=\"language-text\"\u003E$ apt-get update &amp;&amp; apt-get install zip unzip\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EAnd now install composer\u003C\u002Fp\u003E\u003Cpre class=\"language-text\"\u003E\u003Ccode class=\"language-text\"\u003E$ curl -sS [https:\u002F\u002Fgetcomposer.org\u002Finstaller](https:\u002F\u002Fgetcomposer.org\u002Finstaller) | php -- --install-dir=\u002Fusr\u002Fbin\u002F --filename=composer\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003ELet’s check composer is installed and in our path\u003C\u002Fp\u003E\u003Cpre class=\"language-text\"\u003E\u003Ccode class=\"language-text\"\u003E$ composer --version\nComposer version 1.4.2 2017-03-10 09:29:45\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fsection\u003E\n\u003Csection\u003E\u003Ch3 id=\"install-laravel\"\u003E\u003Ca href=\"#install-laravel\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EInstall Laravel\u003C\u002Fh3\u003E\u003Cp\u003ELets install our first laravel application by running following command\u003C\u002Fp\u003E\u003Cpre class=\"language-text\"\u003E\u003Ccode class=\"language-text\"\u003E$ composer create-project --prefer-dist laravel\u002Flaravel example\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EIt’ll create a new laravel app inside example directory. To make it accessible we have to create a example.conf and add example.local domain in \u002Fetc\u002Fhosts file. Also we need to change the owner of storage and boostrap folder like below\u003C\u002Fp\u003E\u003Cpre class=\"language-text\"\u003E\u003Ccode class=\"language-text\"\u003E$ chown -R www-data:www-data storage bootstrap\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003ENow if we visit example.local in the browser we’ll see\u003C\u002Fp\u003E\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F2648\u002F1*0LLdZWXfbqAz8xUi8PomHA.png\"\u003E\u003C\u002Fp\u003E\u003Cp\u003EAdding another application will be same as before: 1) create a new laravel app inside sites directory, 2) add a new .conf file for that application, 3) add a domain in \u002Fetc\u002Fhosts 4) change owner of storage and bootstrap folder to www-data .\u003C\u002Fp\u003E\u003C\u002Fsection\u003E\n\u003Csection\u003E\u003Ch3 id=\"conclusion\"\u003E\u003Ca href=\"#conclusion\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EConclusion\u003C\u002Fh3\u003E\u003Cp\u003EWe have one piece of the puzzle still left, that is database. We’ll see in next post how to add any database to our application and persist the data and also some other tools like redis etc. We’ll also see how can we use another php version to test the same application. Stay tuned!\u003C\u002Fp\u003E\u003Csection\u003E\u003Ch4 id=\"part-2\"\u003E\u003Ca href=\"#part-2\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003E\u003Ca href=\"\u002Flocal-development-environment-with-docker-for-php-2\"\u003EPart-2\u003C\u002Fa\u003E\u003C\u002Fh4\u003E\u003C\u002Fsection\u003E\u003C\u002Fsection\u003E\n","timeToRead":6}},"context":{}};(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());</script><script src="/assets/js/app.b5f97140.js" defer></script><script src="/assets/js/page--src--templates--blog-post-vue.f08fc299.js" defer></script>
  </body>
</html>
